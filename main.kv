#:import utils kivy.utils

<Homescreen>:
    name: 'taotrang'
    MDScreen:
        md_bg_color:239/255,243/255,246/255,1
        name:"SingIn"
        MDBoxLayout:
            orientation:'vertical'
            padding:dp(20)
            spacing:dp(15)
            MDBoxLayout:
                orientation:'vertical'
                size_hint_y:.6
                MDLabel:
                    text:'Welcome'

                MDLabel:
                    text:"Sign In"
                    font_style:'H4'

            MDBoxLayout:
                orientation:'vertical'
                size_hint_y:1.5
                MDLabel:
                    text:"Email"
                NCard:
                    MDBoxLayout:
                        padding:[dp(15),sp(5),dp(15),sp(5)]
                        md_bg_color:239/255,243/255,246/255,1
                        radius:[20]
                        MDTextField:
                            hint_text: 'Tên đăng nhập'
                            id: username
                MDLabel:
                    text:"Password"

                NCard:
                    MDBoxLayout:
                        padding:[dp(15),sp(5),dp(15),sp(5)]
                        md_bg_color:239/255,243/255,246/255,1
                        radius:[20]
                        MDTextField:
                            hint_text: 'Mật khẩu'
							password:True
                            id: password
            MDBoxLayout:
                orientation:'vertical'
                spacing:dp(10)
                size_hint_y:1.1
                MDLabel:
                    text:'Forget your password ?'
                    halign:"center"
                RectangularRippleButton:
                    md_bg_color:app.theme_cls.primary_color
                    padding:"10dp"
                    radius:"20dp"

                    MDTextButton:
                    # MDLabel:
                        text:'Sign In'
                        padding: [350,10,20, 10]
                        size_hint: None, None
                        pos_hint: {"center_x": 0.5, "center_y": 0.5}
                        theme_text_color:"Custom"
                        text_color:1,1,0,1
                        on_release:
                            app.root.transition.direction ="left"
                            app.root.login(username.text, password.text)

                MDLabel:
                    text:'OR'
                    halign:"center"
                MDBoxLayout:
                    size_hint_x:None
                    width:"180sp"
                    pos_hint:{'center_x':.5}
                    spacing:dp(20)
                    RectangularRippleImage:
                        source:"icon/twitter.png"
                    RectangularRippleImage:
                        source:"icon/facebook.png"
                    RectangularRippleImage:
                        source:"icon/instagram.png"


                MDBoxLayout:
                    pos_hint:{'center_x':.5}
                    adaptive_width:True
                    spacing:dp(6)
                    MDLabel:
                        text:"Don't have account ?"
                        text_size:None,None
                        halign:"center"
                        adaptive_size:True
                    MDTextButton:
                        text:"Sign Up"
                        theme_text_color:'Custom'
                        text_color:app.theme_cls.primary_color
    
    MDScreen:
        name:'trangchu'
        id: mainWindow
        MDBoxLayout:
            orientation: 'vertical'
            md_bg_color: 1, 1, 1, 1
            MDBoxLayout:
                orientation: 'vertical'
                size_hint:(1,0.1)
                MDGridLayout:
                    cols:2
                    rows:1
                    Image:
                        source:'icon/logo_ttb.png'
                        # size_hint:(0.09,0.1)
                        size_hint:None,None
                        size:(80,100)
                        padding:0
                    MDLabel:
                        id:tieudettb
                        md_bg_color: app.theme_cls.primary_color
                        padding:20
                        text:'ĐÀI KTTV TTB'
                        font_style:'H6'
            MDBoxLayout:
                size_hint:(1,0.6)
                padding:10
                orientation: 'vertical'
                MDScrollView:
                    MDList:
                        id: provin

        # MDSpinner:
        #     id:spiner
        #     size_hint: None, None
        #     size: dp(46), dp(46)
        #     pos_hint: {'center_x': .5, 'center_y': .5}
        #     active: False     

    MDScreen:
        name:'solieu'
        MDBottomNavigation:
            id:manhinhsolieu
            MDBottomNavigationItem:
                id: solieumua
                name: 'mua'
                text: 'Mưa'
                icon: 'weather-lightning-rainy'
                MDBoxLayout:
                    orientation: 'vertical'
                    MDBoxLayout:
                        size_hint: 1,0.1
                        orientation: 'vertical'
                        md_bg_color: app.theme_cls.primary_color
                        MDGridLayout:
                            cols:3
                            rows:1
                            MDIconButton:
                                icon: "arrow-left-thick"
                                size_hint: None,None
                                pos_hint: {"center_x": .5, "center_y": .5}
                                on_press: app.callback_trangchu()
                            MDTextField:
                                icon_right: "magnify"
                                id: hintexx
                                hint_text: "Tìm kiếm"
                                on_text: app.search_tram(self.text)  # Gọi hàm tìm kiếm khi văn bản thay đổi
                                mode: "round"
                                pos_hint: {"center_x": .5, "center_y": .5}
                            MDIconButton:
                                icon: "sigma"
                                size_hint: None,None
                                pos_hint: {"center_x": .5, "center_y": .5}
                                on_press: app.callback_dienmua()
                    # MDBoxLayout:
                    #     size_hint: 1,0.1
                    #     orientation: 'vertical'
                    #     MDList:
                    #         size_hint: (1, .9)
                    #         cols:4
                    #         text_color: 1,0, 0, 1
                    #         id: tramkttv_mua_title   
                    MDBoxLayout:
                        size_hint: 1,0.9
                        orientation: 'vertical'
                        MDScrollView:
                            do_scroll_x: True
                            do_scroll_y: True
                            MDList:
                                size_hint: (1, 2.9)
                                cols:4
                                text_color: 1,0, 0, 1
                                id: tramkttv_mua_tinh

            MDBottomNavigationItem:
                name: 'mucnuoc'
                text: 'Mực nước'
                icon: 'waves-arrow-up'
                # badge_icon: "numeric-5"
                MDBoxLayout:
                    orientation: 'vertical'
                    MDBoxLayout:
                        orientation: 'vertical'
                        size_hint: 1,0.1
                        md_bg_color: app.theme_cls.primary_color
                        MDGridLayout:
                            cols:2
                            rows:1
                            MDIconButton:
                                icon: "arrow-left-thick"
                                size_hint: None,None
                                pos_hint: {"center_x": .5, "center_y": .5}
                                on_press: app.callback_trangchu()
                            MDTextField:
                                icon_right: "magnify"
                                id: hintexx
                                hint_text: "Tìm kiếm"
                                on_text: app.search_tram(self.text)  # Gọi hàm tìm kiếm khi văn bản thay đổi
                                mode: "round"
                                pos_hint: {"center_x": .5, "center_y": .5}
                    MDBoxLayout:
                        size_hint: 1,0.9
                        orientation: 'vertical'
                        MDScrollView:
                            do_scroll_x: True
                            do_scroll_y: True
                            MDList:
                                size_hint: (1, 2)
                                cols:4
                                text_color: 1,0, 0, 1
                                id: tramkttv_mucnuoc_tinh
            MDBottomNavigationItem:
                name: 'gio'
                text: 'Gió'
                icon: 'wind-power-outline'
                MDBoxLayout:
                    orientation: 'vertical'
                    MDBoxLayout:
                        size_hint: 1,0.1
                        orientation: 'vertical'
                        md_bg_color: app.theme_cls.primary_color
                        MDGridLayout:
                            cols:2
                            rows:1
                            MDIconButton:
                                icon: "arrow-left-thick"
                                size_hint: None,None
                                pos_hint: {"center_x": .5, "center_y": .5}
                                on_press: app.callback_trangchu()
                            MDTextField:
                                icon_right: "magnify"
                                id: hintexx
                                hint_text: "Tìm kiếm"
                                on_text: app.search_tram(self.text)  # Gọi hàm tìm kiếm khi văn bản thay đổi
                                mode: "round"
                                pos_hint: {"center_x": .5, "center_y": .5}
                    MDBoxLayout:
                        size_hint: 1,0.9
                        orientation: 'vertical'
                        MDScrollView:
                            do_scroll_x: True
                            do_scroll_y: True
                            MDList:
                                size_hint: (1, 2)
                                # cols:4
                                text_color: 1,0, 0, 1
                                id: tramkttv_gio_tinh
            MDBottomNavigationItem:
                name: 'nhiet'
                text: 'Nhiệt'
                icon: 'temperature-celsius'
                MDBoxLayout:
                    orientation: 'vertical'
                    MDBoxLayout:
                        orientation: 'vertical'
                        size_hint: 1,0.1
                        md_bg_color: app.theme_cls.primary_color
                        MDGridLayout:
                            cols:2
                            rows:1
                            MDIconButton:
                                icon: "arrow-left-thick"
                                size_hint: None,None
                                pos_hint: {"center_x": .5, "center_y": .5}
                                on_press: app.callback_trangchu()
                            MDTextField:
                                icon_right: "magnify"
                                id: hintexx
                                hint_text: "Tìm kiếm"
                                on_text: app.search_tram(self.text)  # Gọi hàm tìm kiếm khi văn bản thay đổi
                                mode: "round"
                                pos_hint: {"center_x": .5, "center_y": .5}
                    MDBoxLayout:
                        size_hint: 1,0.9
                        orientation: 'vertical'
                        MDScrollView:
                            do_scroll_x: True
                            do_scroll_y: True
                            MDList:
                                size_hint: (1, 2)
                                cols:4
                                text_color: 1,0, 0, 1
                                id: tramkttv_nhiet_tinh      
            MDBottomNavigationItem:
                name: 'ap'
                text: 'Khác'
                id:yeutokhac
                icon: 'vector-difference'
                MDBoxLayout:
                    orientation: 'vertical'
                    MDBoxLayout:
                        orientation: 'vertical'
                        md_bg_color: app.theme_cls.primary_color
                        MDGridLayout:
                            cols:2
                            rows:1
                            MDIconButton:
                                icon: "arrow-left-thick"
                                size_hint: None,None
                                pos_hint: {"center_x": .5, "center_y": .5}
                                on_press: app.callback_trangchu()
                            MDTextField:
                                icon_right: "magnify"
                                id: hintexx
                                hint_text: "Tìm kiếm"
                                on_text: app.search_tram(self.text)  # Gọi hàm tìm kiếm khi văn bản thay đổi
                                mode: "round"
                                pos_hint: {"center_x": .5, "center_y": .5}
                    MDBoxLayout:
                        size_hint: None,None
                        size: (root.width * 0.96, root.height * 0.80)
                        padding:10
                        orientation: 'vertical'
                        MDScrollView:
                            MDList:
                                id: tramkttv_ap_tinh      

    MDScreen:
        name:'tram'
        MDBoxLayout:
            orientation: 'vertical'
            md_bg_color: 1, 1, 1, 1
            id:scr_solieutramchitiet
            MDBoxLayout:
                orientation: 'vertical'
                md_bg_color: app.theme_cls.primary_color
                size_hint:(1,0.1)
                MDGridLayout:
                    cols:3
                    rows:1
                    MDIconButton:
                        icon: "arrow-left-thick"
                        # size_hint: None,None
                        pos_hint: {"center_x": .5, "center_y": .5}
                        on_press: app.callback_solieu()
                    MDLabel:
                        id: tieude_tram_click
                        text:''
                        font_style:'H6'
                        halign:"center"
                    MDIconButton:
                        icon: "chart-scatter-plot"
                        # size_hint: None,None
                        pos_hint: {"center_x": .5, "center_y": .5}
                        on_press: app.vebieudo()            

            
            MDBoxLayout:
                # id:scr_solieutramchitiet
                size_hint:(1,0.9)
                orientation: 'vertical'
                MDScrollView:
                    MDList:
                        # cols:4
                        id: solieutram

    MDScreen:
        name: 'bieudo'
        canvas.before:
            Color:
                rgb: utils.get_color_from_hex('#212946')
            Rectangle:
                pos: self.pos
                size: self.size
        MDBoxLayout:
            # size_hint: 1, 1
            orientation: 'vertical'
            MDGridLayout:
                size_hint: 1, 0.1
                md_bg_color: app.theme_cls.primary_color
                cols:3
                rows:1
                MDIconButton:
                    icon: "arrow-left-thick"
                    # size_hint: None,None
                    pos_hint: {"center_x": .5, "center_y": .5}
                    on_press: app.callback_solieu_chitiet()
                MDLabel:
                    id: tieude_tram_bieudo
                    text:''
                    font_style:'H6'
                    halign:"center"
                MDIconButton:
                    icon: "chart-bar"
                    # size_hint: None,None
                    pos_hint: {"center_x": .5, "center_y": .5}
                    on_press: app.vebieudo_bar()            
            MDScrollView:
                id: view
                do_scroll_x: True
                do_scroll_y: False
                orientation: 'vertical'
                size_hint: 1, 0.8
                valign: 'middle'
                bar_width: 4
                bar_color: 1, 1, 1, 1
                bar_inactive_color: 1, 1, 1, 0.5
                scroll_type: ['content']
                MDBoxLayout:
                    orientation: 'vertical'
                    size_hint: None, 1
                    width: root.width
                    MDBoxLayout:
                        id: modulation
                        size_hint_x: 1
                        size_hint_y: 1


    MDScreen:
        name: 'dienmua'
        id: dienmua
        # md_bg_color: app.theme_cls.primary_color
        MDBoxLayout:
            # size_hint: (1, 0.1)
            md_bg_color:app.theme_cls.primary_color        
            orientation: 'vertical'
            
            MDGridLayout:
                size_hint: (1, 0.1)
                cols:2
                rows:1
                MDIconButton:
                    icon: "arrow-left-thick"
                    pos_hint: {"center_x": .5, "center_y": .5}
                    on_press: app.callback_solieu()
                MDLabel:
                    text:'Tổng kết số liệu'
            MDBoxLayout:
                # id:muatongket
                size_hint: (1, 0.9)
                orientation: 'vertical'
                md_bg_color:1, 1, 1, 1
                MDScrollView:
                    # size_hint: None, 0.8
                    do_scroll_x: True
                    do_scroll_y: True
                    bar_color: 0, 0, 100, 1
                    bar_width: 2
                    MDList:
                        size_hint: (1.8, 6)
                        cols:8
                        text_color: 1,0, 0, 1
                        width: self.minimum_width
                        height: self.minimum_height
                        id: dienmua_layout 
# <LoadingWidget>:
#     id:manhinhcho
#     name:'manhinhcho'
#     MDSpinner:
#         size_hint: None, None
#         size: dp(48), dp(48)
#         pos_hint: {'center_x': .5, 'center_y': .5}
#         active: True


<RectangularRippleButton>:
<RectangularRippleImage>:
<NCard@MDBoxLayout>:
    canvas.before:
        Color:
            rgba:(0,0,0,.1)
        RoundedRectangle:
            size:self.size
            pos:self.pos[0]+6,self.pos[1]-4
            radius:[20]
        Color:
            rgba:1, 1, 1, 0.8
        RoundedRectangle:
            size:self.size
            pos:self.pos[0]-6,self.pos[1]+4
            radius:[20]

# <GraphWidget@Widget>:
#     Graph:
#         id: graph
#         size_hint: 1, 1